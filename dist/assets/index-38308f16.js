(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function l(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerpolicy&&(t.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?t.credentials="include":n.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(n){if(n.ep)return;n.ep=!0;const t=l(n);fetch(n.href,t)}})();function k(r){let o=new Map;for(let l=0;l<r.length;l++)o.set(r[l],L(r[l]+".txt"));return o}function L(r){var o=new XMLHttpRequest;o.open("GET",r,!1),o.send();for(var l=o.responseText.split(`
`),e=[],n=0;n<l.length;n++){for(var t=l[n].replace(`
`,"").split(";"),i={title:t[0],isSingleAnswerQuestion:t[1]==="true",responses:[]},c=2;c<t.length;c++)i.responses.push(t[c]);e.push(i)}return e}let m=0;function g(r){let o="";o+='<table class="table table-light table-striped"><tbody>',o+='<tr class="form-group"><th class="col-4">Nom du fichier Excel :</th><th class="col-4"><input type="text" id="fileName"></th></tr>',r.forEach(e=>{o+=`<tr class="form-group">
<th class="col-4">${e.title}</th>`,e.responses.forEach(n=>{let t=e.isSingleAnswerQuestion?"radio":"checkbox";o+=`
        <th class="form-check form-check-inline cel">
            <input class="form-check-input" type="${t}" name="${e.title}" id="${e.title}-${n}" value="${n}">
            <label class="form-check-label d-block" for="${e.title}-${n}">${n}</label>
        </th>`}),o+="</tr>"}),o+="</tbody></table>",o+=`<div class="container text-center mb-5 ">
                    <div class="row justify-content-evenly"> 
                        <button class="col-3 btn btn-primary" id="submitButton">Saisir la prochaine fiche</button>
                        <div class="col">Nombre de saisies :<div id="nbSaissi">0</div></div>
                        <button class="col-3 btn btn-danger" id="finishButton">Générer le fichier Excel</button>
                    </div>
                </div>    `,document.getElementById("body").innerHTML=o;let l={};p(r,l),document.getElementById("submitButton").addEventListener("click",function(){r.forEach(e=>{document.getElementsByName(e.title).forEach(t=>{t.checked&&(l[e.title]||(l[e.title]={}),l[e.title][t.value]||(l[e.title][t.value]=0),l[e.title][t.value]++),t.checked=!1})}),document.getElementById("nbSaissi").innerHTML=m+=1}),document.getElementById("finishButton").addEventListener("click",function(){r.forEach(e=>{document.getElementsByName(e.title).forEach(t=>{t.checked&&(l[e.title]||(l[e.title]={}),l[e.title][t.value]||(l[e.title][t.value]=0),l[e.title][t.value]++),t.checked=!1})}),w(l,document.getElementById("fileName").value,"sheetName"),document.getElementById("nbSaissi").innerHTML=m=0,l={},p(r,l)})}function w(r,o,l){const e=".xlsx",n=localStorage.getItem(o)!==null;let t;if(n){const a=localStorage.getItem(o),s=new Uint8Array(atob(a).split("").map(d=>d.charCodeAt(0)));t=XLSX.read(s,{type:"array"})}else t=XLSX.utils.book_new();t=XLSX.utils.book_new();const i=[];for(const a in r){const s=[a],d=r[a];for(const h in d){const v=h.trim(),E=d[h];s.push(v),s.push(E)}i.push(s)}const c=XLSX.utils.aoa_to_sheet(i);XLSX.utils.book_append_sheet(t,c,l);const u=XLSX.write(t,{bookType:"xlsx",type:"array"}),y=btoa(String.fromCharCode.apply(null,u));localStorage.setItem(o,y),saveAs(new Blob([u],{type:"application/octet-stream"}),o+e)}function p(r,o){r.forEach(l=>{o[l.title]||(o[l.title]={},l.responses.forEach(e=>{o[l.title][e]=0}))})}function B(r,o){let l="";for(let e=0;e<r.length;e++)l+=`
        <li class="nav-item">
            <a class="nav-link btn-${e==0?"light":"secondary"}" id="${r[e]}" href="#">${r[e]}</a>
        </li>
        `;document.getElementById("nav").innerHTML=l;for(let e=0;e<r.length;e++)document.getElementById(r[e]).addEventListener("click",function(){g(o.get(r[e]));for(let n=0;n<r.length;n++)document.getElementById(r[n]).classList.replace("btn-light","btn-secondary");this.classList.add("btn-light")})}var f=["Questionnaire élève AAC collège","Questionnaire élève AAC lycée","Questionnaire élève CAPO","Questionnaire élève CM2"],b=k(f);B(f,b);g(b.get(f[0]));
